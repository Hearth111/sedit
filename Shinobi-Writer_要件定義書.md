# TRPGシナリオエディタ『Shinobi-Writer』要件定義書

## 1. プロジェクト概要
- **形式**: シングルファイルHTMLアプリケーション（HTML/CSS/JSのみ、サーバー・インストール不要）。
- **コンセプト**: "Print-First Design"。画面上では執筆に集中し、ブラウザの印刷機能を使って2段組PDFを出力する。
- **ターゲットシステム**: 『シノビガミ』等の2段組・データ重視のTRPGシステム。

## 2. UI/UXデザイン
- **テーマカラー**
  - **ダークモード**: 背景色は漆黒（`#1a1a1a`）、アクセントに深紅（`#d00`）。目に優しく、没入感のあるデザイン。
- **画面レイアウト（3カラム構成）**
  1. **左：ツール/設定パネル**: ツールボックス、目次、設定入力。
  2. **中：エディタ**: マークダウン入力エリア。
  3. **右：簡易プレビュー**: 印刷イメージ確認用（スクロール表示）。
- **表示モード切替**
  - **デュアルビュー**: エディタ＋プレビュー（標準）。
  - **シングルビュー**: エディタのみ / プレビューのみに切り替え可能。

## 3. エディタ・執筆機能
- **独自記法（Markdown拡張） & パーサー**
  - `# タイトル`: シーン見出し（黒帯＋赤ライン＋影）。
  - `> テキスト`: 描写ボックス（グレー網掛け）。
  - `{{HO1}}`: ハンドアウト枠（使命・秘密のテンプレート）。
  - `{{SceneTable}}`: シーン表テンプレート。
  - `:::secret 内容 :::`: 袋とじ（黒塗り、クリックで開示）。
  - `{漢字}(ルビ)`: ルビ振り機能。
  - `---`: 強制改ページマーカー。
- **入力支援（GUI）**
  - **ツールボックス**: 独自記法をワンクリックで挿入するボタン群（GIMPのツールボックス風）。
  - **スニペット登録**: ユーザーがよく使う定型文を登録・呼び出し可能にする。
  - **コピーボタン**: 選択テキストやデータをクリップボードにコピー。
- **テーブル作成**
  - 汎用的な表作成記法。
  - シノビガミ用シーン表のテンプレート挿入。

## 4. ナビゲーション機能
- **目次（TOC）**
  - 見出しタグ（`#`）を自動検知してリスト化。
  - クリックするとエディタ・プレビュー両方が該当箇所へスクロール同期。
  - サイドバーに「縦タブ」として格納。

## 5. 出力・印刷仕様（CSS `@media print`）
- **PDF出力（ブラウザ印刷機能利用）**
  - **用紙**: A4サイズ、縦向き。
  - **レイアウト**: 基本**2段組**（`column-count: 2`）、両端揃え（Justify）。
  - **1ページ目特殊レイアウト**
    - 上部：**トレーラー画像**（全幅）＋ シナリオタイトル ＋ 概要。
    - 下部：本文開始（ここから2段組）。
  - **崩れ防止（Break Control）**
    - 見出し、データ枠、画像が段やページの途中で切れないよう制御（`break-inside: avoid`）。
- **その他の書き出し**
  - `.txt` / `.md`（プレーンテキスト）。
  - `.html`（配布用）。

## 6. データ管理・システム連携
- **プロジェクト保存**
  - 執筆内容、設定（画像URL等）をまとめて `.json` 形式で保存・読込。
  - ショートカットキー `Ctrl+S` で保存ダイアログ呼び出し。
- **自動保存**
  - `LocalStorage` を利用し、ブラウザを閉じても内容を保持。
- **外部ツール連携（ココフォリア）**
  - **敵駒出力**: 入力されたエネミーデータを、ココフォリアにペースト可能なJSON形式でクリップボードにコピーする機能。
